ğŸ” å¼€å§‹æ•°æ®å®Œæ•´æ€§æ£€æŸ¥...

=== 1. è®¢å•æ•°æ®å®Œæ•´æ€§ ===
æ£€æŸ¥ 1.1: è®¢å•é‡‘é¢æ˜¯å¦æ­£ç¡®...
 order_id | recorded_total | calculated_total | difference 
----------+----------------+------------------+------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ‰€æœ‰è®¢å•é‡‘é¢æ­£ç¡®ï¼‰

æ£€æŸ¥ 1.2: å­¤ç«‹çš„è®¢å•é¡¹...
 order_item_id | order_id | product_id | quantity 
---------------+----------+------------+----------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ²¡æœ‰å­¤ç«‹çš„è®¢å•é¡¹ï¼‰

æ£€æŸ¥ 1.3: æ²¡æœ‰è®¢å•é¡¹çš„è®¢å•...
 id | email | status | total | created_at 
----+-------+--------+-------+------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œæˆ–åªæœ‰ pending/expired/cancelled è®¢å•

æ£€æŸ¥ 1.4: Paid è®¢å•çš„ Stripe Session ID...
 id | email | status | total | stripe_session_id | created_at 
----+-------+--------+-------+-------------------+------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ‰€æœ‰ paid è®¢å•éƒ½æœ‰ session IDï¼‰

æ£€æŸ¥ 1.5: é‡å¤çš„ Stripe Session ID...
 stripe_session_id | order_count | order_ids 
-------------------+-------------+-----------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ¯ä¸ª session åªå¯¹åº”ä¸€ä¸ªè®¢å•ï¼‰

æ£€æŸ¥ 1.6: è®¢å•é¡¹å¼•ç”¨ä¸å­˜åœ¨çš„äº§å“...
 order_item_id | order_id | product_id | quantity 
---------------+----------+------------+----------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ‰€æœ‰äº§å“éƒ½å­˜åœ¨ï¼‰


=== 2. äº§å“æ•°æ®å®Œæ•´æ€§ ===
æ£€æŸ¥ 2.1: è´Ÿæ•°åº“å­˜...
psql:data-integrity/integrity-checks.sql:111: ERROR:  column "stock" does not exist
LINE 4:     stock,
            ^
  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆåº“å­˜ä¸èƒ½ä¸ºè´Ÿï¼‰

æ£€æŸ¥ 2.2: æ— æ•ˆä»·æ ¼...
psql:data-integrity/integrity-checks.sql:123: ERROR:  column "price_cad" does not exist
LINE 4:     price_cad,
            ^
  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆä»·æ ¼å¿…é¡»ä¸ºæ­£æ•°ï¼‰

æ£€æŸ¥ 2.3: å­¤ç«‹çš„äº§å“å›¾ç‰‡...
 image_id | product_id | cloudinary_public_id | display_order 
----------+------------+----------------------+---------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ²¡æœ‰å­¤ç«‹çš„å›¾ç‰‡è®°å½•ï¼‰

æ£€æŸ¥ 2.4: æ²¡æœ‰å›¾ç‰‡çš„äº§å“...
psql:data-integrity/integrity-checks.sql:149: ERROR:  column p.price_cad does not exist
LINE 4:     p.price_cad,
            ^
  âš ï¸  è¿™äº›äº§å“æ²¡æœ‰å›¾ç‰‡ï¼ˆå¯èƒ½éœ€è¦æ·»åŠ ï¼‰

æ£€æŸ¥ 2.5: äº§å“å¼•ç”¨ä¸å­˜åœ¨çš„åˆ†ç±»...
 id | name | category_id 
----+------+-------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ‰€æœ‰åˆ†ç±»éƒ½å­˜åœ¨ï¼‰


=== 3. ç”¨æˆ·æ•°æ®å®Œæ•´æ€§ ===
æ£€æŸ¥ 3.1: é‡å¤çš„ç”¨æˆ·é‚®ç®±...
 email | user_count | user_ids 
-------+------------+----------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆé‚®ç®±å¿…é¡»å”¯ä¸€ï¼‰

æ£€æŸ¥ 3.2: OAuth ç”¨æˆ·çš„å¯†ç å­—æ®µ...
psql:data-integrity/integrity-checks.sql:192: ERROR:  column "oauth_provider" does not exist
LINE 4:     oauth_provider
            ^
  âš ï¸  OAuth ç”¨æˆ·åº”è¯¥æ²¡æœ‰å¯†ç å“ˆå¸Œ

æ£€æŸ¥ 3.3: æ™®é€šç”¨æˆ·ç¼ºå°‘å¯†ç ...
psql:data-integrity/integrity-checks.sql:204: ERROR:  column "oauth_provider" does not exist
LINE 4:     oauth_provider
            ^
  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ™®é€šç”¨æˆ·å¿…é¡»æœ‰å¯†ç ï¼‰

æ£€æŸ¥ 3.4: è®¢å•å…³è”åˆ°ä¸å­˜åœ¨çš„ç”¨æˆ·...
 order_id | user_id | email | status 
----------+---------+-------+--------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ‰€æœ‰ç”¨æˆ·éƒ½å­˜åœ¨ï¼‰


=== 4. ç‰©æµæ•°æ®å®Œæ•´æ€§ ===
æ£€æŸ¥ 4.1: Shipped è®¢å•çš„ç‰©æµä¿¡æ¯...
 id | email | status | tracking_number | carrier | shipped_at 
----+-------+--------+-----------------+---------+------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ‰€æœ‰å‘è´§è®¢å•éƒ½æœ‰ç‰©æµä¿¡æ¯ï¼‰

æ£€æŸ¥ 4.2: ç‰©æµä¿¡æ¯ä½†çŠ¶æ€ä¸æ˜¯ shipped/delivered...
 id | email | status | tracking_number | carrier 
----+-------+--------+-----------------+---------
(0 rows)

  âš ï¸  è¿™äº›è®¢å•æœ‰ç‰©æµä¿¡æ¯ä½†çŠ¶æ€å¼‚å¸¸

æ£€æŸ¥ 4.3: å‘è´§æ—¶é—´æ—©äºè®¢å•åˆ›å»ºæ—¶é—´...
 id | email | created_at | shipped_at | time_diff 
----+-------+------------+------------+-----------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆå‘è´§æ—¶é—´ä¸èƒ½æ—©äºåˆ›å»ºæ—¶é—´ï¼‰

æ£€æŸ¥ 4.4: Paid è®¢å•ç¼ºå°‘æ”¶è´§åœ°å€...
 id |       email       |  status   | shipping_address | shipping_name |          created_at           
----+-------------------+-----------+------------------+---------------+-------------------------------
 14 | test@example.com  | delivered |                  |               | 2025-12-01 01:40:27.104636+00
 15 | test@example.com  | paid      |                  |               | 2025-12-01 02:47:02.022323+00
 16 | test@example.com  | paid      |                  |               | 2025-12-01 18:46:31.987437+00
 20 | test@example.com  | paid      |                  |               | 2025-12-03 00:56:14.188237+00
 21 | test@test.com     | paid      |                  |               | 2025-12-04 05:17:12.176392+00
 22 | test@test.com     | paid      |                  |               | 2025-12-04 20:01:11.793326+00
 23 | test@test.com     | paid      |                  |               | 2025-12-04 20:08:39.086942+00
 24 | test@test.com     | paid      |                  |               | 2025-12-04 20:14:20.337352+00
 25 | testpage@page.com | paid      |                  |               | 2025-12-04 20:26:46.251096+00
 26 | wow@wow.com       | paid      |                  |               | 2025-12-05 02:28:31.746851+00
 28 | wow@wow.com       | paid      |                  |               | 2025-12-05 05:32:38.480013+00
 29 | test@test.com     | paid      |                  |               | 2025-12-08 19:55:35.301523+00
 50 | 989994@gmail.com  | paid      |                  |               | 2025-12-16 00:19:03.419399+00
 51 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 02:18:56.03486+00
 52 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 02:49:27.390954+00
 53 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 09:56:01.551899+00
 54 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 09:57:43.242957+00
 56 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 10:05:57.834503+00
 57 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 10:25:47.583413+00
 58 | 989994@gmail.com  | paid      |                  |               | 2025-12-18 10:27:24.004607+00
 10 | test@example.com  | shipped   |                  |               | 2025-11-29 01:55:34.820921+00
 59 | 989994@gmail.com  | shipped   |                  |               | 2025-12-18 10:29:07.205646+00
 69 | 989994@gmail.com  | delivered |                  |               | 2025-12-19 09:35:53.348248+00
(23 rows)

  âš ï¸  è¿™äº›è®¢å•æ²¡æœ‰æ”¶è´§åœ°å€ï¼ˆå¯èƒ½æ˜¯æ—§æ•°æ®ï¼‰


=== 5. åˆ†ç±»æ•°æ®å®Œæ•´æ€§ ===
æ£€æŸ¥ 5.1: ç©ºåˆ†ç±»ï¼ˆæ²¡æœ‰äº§å“ï¼‰...
 id |  name   |  slug   | product_count 
----+---------+---------+---------------
  2 | other   | other   |             0
  1 | chassis | chassis |             0
(2 rows)

  âš ï¸  è¿™äº›åˆ†ç±»æ²¡æœ‰äº§å“ï¼ˆå¯ä»¥è€ƒè™‘åˆ é™¤ï¼‰

æ£€æŸ¥ 5.2: é‡å¤çš„åˆ†ç±» slug...
 slug | count | categories 
------+-------+------------
(0 rows)

  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆslug å¿…é¡»å”¯ä¸€ï¼‰


=== 6. ä¸šåŠ¡é€»è¾‘æ£€æŸ¥ ===
æ£€æŸ¥ 6.1: è¶…è¿‡ 24 å°æ—¶ä» pending çš„è®¢å•...
 id |      email       | status  | total  |          created_at           |           age           
----+------------------+---------+--------+-------------------------------+-------------------------
 11 | test@example.com | pending | 379.89 | 2025-11-29 01:58:46.633278+00 | 23 days 04:21:10.652798
 12 | test@example.com | pending |  29.90 | 2025-11-29 02:00:42.758682+00 | 23 days 04:19:14.527394
 13 | test@example.com | pending | 578.99 | 2025-11-30 08:37:45.762495+00 | 21 days 21:42:11.523581
 17 | test@example.com | pending |  59.80 | 2025-12-02 04:27:53.415531+00 | 20 days 01:52:03.870545
 18 | test@example.com | pending | 379.89 | 2025-12-02 04:30:28.297731+00 | 20 days 01:49:28.988345
 19 | test@test.com    | pending |  29.90 | 2025-12-02 04:33:32.577988+00 | 20 days 01:46:24.708088
 27 | wow@wow.com      | pending | 578.99 | 2025-12-05 02:29:11.969515+00 | 17 days 03:50:45.316561
 30 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:54.404728+00 | 11 days 02:00:02.881348
 31 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:55.003785+00 | 11 days 02:00:02.282291
 32 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:55.63081+00  | 11 days 02:00:01.655266
 33 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:56.210828+00 | 11 days 02:00:01.075248
 34 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:56.831757+00 | 11 days 02:00:00.454319
 35 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:57.398778+00 | 11 days 01:59:59.887298
 36 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:58.033728+00 | 11 days 01:59:59.252348
 37 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:58.628745+00 | 11 days 01:59:58.657331
 38 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:59.194799+00 | 11 days 01:59:58.091277
 39 | test@test.com    | pending |  29.90 | 2025-12-11 04:19:59.810758+00 | 11 days 01:59:57.475318
 40 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:30.159724+00 | 11 days 01:57:27.126352
 41 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:30.738727+00 | 11 days 01:57:26.547349
 42 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:31.306795+00 | 11 days 01:57:25.979281
 43 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:31.910767+00 | 11 days 01:57:25.375309
 44 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:32.498791+00 | 11 days 01:57:24.787285
 45 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:33.111807+00 | 11 days 01:57:24.174269
 46 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:34.375148+00 | 11 days 01:57:22.910928
 47 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:35.403875+00 | 11 days 01:57:21.882201
 48 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:36.374986+00 | 11 days 01:57:20.91109
 49 | test@test.com    | pending |  29.90 | 2025-12-11 04:22:37.426781+00 | 11 days 01:57:19.859295
 55 | 989994@gmail.com | pending |  59.80 | 2025-12-18 10:01:21.903402+00 | 3 days 20:18:35.382674
(28 rows)

  âš ï¸  è¿™äº›è®¢å•å¯èƒ½éœ€è¦æ ‡è®°ä¸º expired

æ£€æŸ¥ 6.2: å¼‚å¸¸é«˜ä»·è®¢å•ï¼ˆ> $10,000ï¼‰...
 id | email | status | total | created_at 
----+-------+--------+-------+------------
(0 rows)

  âš ï¸  æ£€æŸ¥è¿™äº›é«˜ä»·è®¢å•æ˜¯å¦æ­£å¸¸

æ£€æŸ¥ 6.3: å•ä¸ªäº§å“æ•°é‡ > 100 çš„è®¢å•é¡¹...
 id | order_id | product_id | product_name | quantity | email | status 
----+----------+------------+--------------+----------+-------+--------
(0 rows)

  âš ï¸  æ£€æŸ¥è¿™äº›å¤§æ‰¹é‡è®¢å•æ˜¯å¦åˆç†

æ£€æŸ¥ 6.4: ä½åº“å­˜äº§å“...
psql:data-integrity/integrity-checks.sql:383: ERROR:  column "stock" does not exist
LINE 4:     stock,
            ^
  âš ï¸  è¿™äº›äº§å“åº“å­˜è¾ƒä½ï¼Œéœ€è¦è¡¥è´§

æ£€æŸ¥ 6.5: æ£€æŸ¥å¯èƒ½çš„è¶…å–æƒ…å†µ...
psql:data-integrity/integrity-checks.sql:407: ERROR:  column p.stock does not exist
LINE 14:     p.stock as current_stock,
             ^
  âœ“ åº”è¯¥è¿”å› 0 è¡Œï¼ˆæ²¡æœ‰è¶…å–ï¼‰


=== 7. æ€§èƒ½å’Œç´¢å¼•æ£€æŸ¥ ===
æ£€æŸ¥ 7.1: è¡¨æ•°æ®é‡ç»Ÿè®¡...
   table_name   | row_count 
----------------+-----------
 order_items    |        71
 orders         |        54
 product_images |        15
 products       |         6
 users          |         6
 categories     |         2
(6 rows)

  â„¹ï¸  è¡¨æ•°æ®é‡ç»Ÿè®¡

æ£€æŸ¥ 7.2: å¸¸ç”¨æŸ¥è¯¢å­—æ®µçš„ç´¢å¼•...
 schemaname |       tablename       |             indexname              
------------+-----------------------+------------------------------------
 public     | addresses             | addresses_pkey
 public     | addresses             | idx_addresses_user
 public     | addresses             | idx_addresses_user_default_created
 public     | addresses             | uq_addresses_dedupe
 public     | addresses             | uq_addresses_one_default_per_user
 public     | cart_items            | cart_items_pkey
 public     | cart_items            | cart_items_user_id_product_id_key
 public     | cart_items            | idx_cart_items_user
 public     | categories            | categories_pkey
 public     | categories            | uq_categories_name
 public     | categories            | uq_categories_slug
 public     | inventory             | idx_inventory_updated_at
 public     | inventory             | inventory_pkey
 public     | order_items           | idx_order_items_order_id
 public     | order_items           | idx_order_items_product_id
 public     | order_items           | order_items_pkey
 public     | order_items           | uq_order_items_order_product
 public     | orders                | idx_orders_tracking_number
 public     | orders                | orders_pkey
 public     | orders                | uq_orders_stripe_session_id
 public     | password_reset_tokens | idx_reset_tokens_token
 public     | password_reset_tokens | password_reset_tokens_pkey
 public     | password_reset_tokens | password_reset_tokens_user_id_key
 public     | product_images        | idx_product_images_product
 public     | product_images        | product_images_pkey
 public     | products              | products_pkey
 public     | users                 | users_email_key
 public     | users                 | users_pkey
(28 rows)

  â„¹ï¸  å½“å‰ç´¢å¼•åˆ—è¡¨


=== 8. æ•°æ®è´¨é‡ç»Ÿè®¡ ===
ç»Ÿè®¡ 8.1: è®¢å•çŠ¶æ€åˆ†å¸ƒ...
  status   | count | percentage 
-----------+-------+------------
 pending   |    28 |      51.85
 paid      |    21 |      38.89
 delivered |     3 |       5.56
 shipped   |     2 |       3.70
(4 rows)


ç»Ÿè®¡ 8.2: äº§å“åˆ†ç±»åˆ†å¸ƒ...
 category | product_count 
----------+---------------
 æœªåˆ†ç±»   |             6
(1 row)


ç»Ÿè®¡ 8.3: ç”¨æˆ·æ³¨å†Œæ¥æº...
psql:data-integrity/integrity-checks.sql:483: ERROR:  column "oauth_provider" does not exist
LINE 2:     COALESCE(oauth_provider, 'email') as registration_method...
                     ^

ç»Ÿè®¡ 8.4: æœ€è¿‘ 7 å¤©è®¢å•ç»Ÿè®¡...
    date    | order_count | total_revenue | avg_order_value 
------------+-------------+---------------+-----------------
 2025-12-22 |           2 |        579.98 |          289.99
 2025-12-20 |           1 |        289.99 |          289.99
 2025-12-19 |           1 |        289.99 |          289.99
 2025-12-18 |           8 |       1378.67 |          172.33
 2025-12-16 |           1 |        319.89 |          319.89
(5 rows)


âœ… æ•°æ®å®Œæ•´æ€§æ£€æŸ¥å®Œæˆï¼
è¯·æ£€æŸ¥ä¸Šè¿°ç»“æœï¼Œä¿®å¤å‘ç°çš„é—®é¢˜ã€‚

